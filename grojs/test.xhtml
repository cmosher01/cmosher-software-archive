<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<script type="text/javascript">
			/* <![CDATA[ */
			function bodyAppend(tagName, innerHTML) {
				var elm;
			
				elm = document.createElement(tagName);
				elm.innerHTML = innerHTML;
				document.body.appendChild(elm);
			}

			function showResult(result) {
				var markup, n, aByte, byteStr;

				markup = [];
				for (n = 0; n < result.length; ++n) {
					aByte = result.charCodeAt(n);
					byteStr = aByte.toString(16);
					if (byteStr.length < 2) {
						byteStr = "0" + byteStr;
					}
					markup.push(byteStr);
				}
				bodyAppend("pre", markup.join(" "));
			}

			function filereader_onload(e) {
				var i;
				var t;
				var p;
				var ed;
				var rs;
				var f;

				ed = document.getElementById("file_lines");

				f = e.target.result;
				f = f.replace("/n/r","/r/n");
				f = f.replace("/r/n","/n");
				f = f.replace("/r","/n");
				rs = f.match(/^.*$/mg);
				for (i = 0; i < rs.length; i++) {
					t = document.createTextNode(rs[i]);
					p = document.createElement("br");
					ed.appendChild(p)
					ed.appendChild(t);
				}
			}
			function load() {
				var finput;
				var f;
				var r;

				finput = document.getElementById("data");

				f = finput.files[0];

				if (f) {
					r = new FileReader();
					r.onload = filereader_onload;
					r.readAsText(f);
				} else {
					alert("Failed to load file");
				}
			}
			/* ]]> */
		</script>
	</head>
	<body>
		<h3>HTML File Reader Test</h3>
		<p>
			<label for="data">Select a file:</label>
			<input type="file" id="data" />
			<a href="#" onclick="load()">Load</a>
		</p>
		<div id="file_lines" />
	</body>
</html>

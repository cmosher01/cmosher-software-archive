<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<!--#include virtual="head.ihtml" -->
		<title>Epple ][ Clock Card</title>
	</head>
	<body>
		<div id="container">
			<!--#include virtual="navigation.ihtml" -->
			<div id="content">
				<h3>Clock Card</h3>
				<p>
					The clock card emulates a ProDOS-compatible real-time clock card for the Apple ][.
					To use a clock card, you will need to configure the EPPLE ][ to insert one into
					a slot, typically slot 4. You will also need to load the card with its ROM code,
					which is provided with the emulator in the clock.ex65 file.
					For example, add this to your epple2.conf file:
				</p>
<p>
<code><pre>slot 4 clock
import slot 4 rom 0 /usr/lib/epple2/cards/clock.ex65</pre></code>
</p>
<p>
	Of course you may need to adjust the path for your particular system.
</p>
<p>
	To verify that the clock card is working correctly, you can run the following Applesoft
	program to retrieve the current time from the clock card and print it.
	This program assumes the card is in slot 4.
</p>
<p>
<code><pre>
NEW

10 CALL -15360 : REM $C400 SLOT 4 ENTRY POINT
20 A = 512 : REM $0200 INPUT BUFFER
30 C = PEEK(A)
40 IF C < 160 THEN 99
50 PRINT CHR$(C);
60 A = A+1
70 GOTO 30
99 END

RUN
</pre></code>
</p>
<p>
	The card returns data (into the GETLN input buffer at $200) in
	the following format:
</p>
<p>
<code>mm,ww,dd,hh,nn,ss,000,yyyy,Time Zone,v</code>
</p>
<table>
	<tbody>
		<tr><td><code>mm</code></td><td>Month, 01-12</td></tr>
		<tr><td><code>ww</code></td><td>Weekday, 00=Monday... 06=Saturday</td></tr>
		<tr><td><code>dd</code></td><td>Day, 01-31</td></tr>
		<tr><td><code>hh</code></td><td>Hour, 00-23</td></tr>
		<tr><td><code>nn</code></td><td>Minute, 00-59</td></tr>
		<tr><td><code>ss</code></td><td>Second, 00-61</td></tr>
		<tr><td><code>000</code></td><td>Milliseconds; always zero</td></tr>
		<tr><td><code>yyyy</code></td><td>Year, e.g., 2008</td></tr>
		<tr><td><code>Time Zone</code></td><td>time zone string (could contain lower-case characters,
			which won't display correctly)</td></tr>
		<tr><td><code>v</code></td><td>Daylight Saving Time in effect, 0=no, 1=yes</td></tr>
	</tbody>
</table>
<p>
	Note that only (mm,ww,dd,hh,nn) fields are used by ProDOS. The other
	fields (ss,000,yyyy,Time Zone,v) are an EPPLE ][ extension. Also note
	that ProDOS was not designed to work for years as far as 2008, so
	ProDOS will show the incorrect year, but the other fields will be accurate.
	I believe patches exist for ProDOS to fix this.
</p>
			</div>
			<!--#include virtual="footer.ihtml" -->
		</div>
	</body>
</html>

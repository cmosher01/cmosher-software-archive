(app startup) [synchronized (currentItemLock)]
    current = create new
    put current to screen
    add current to list (text, name)
    add current to listener
    select current in list
    dirty = false

insert item (from listener) [synchronized (currentItemLock)]
    add inserted item to list (text, name)

update item (from listener) [synchronized (currentItemLock)]
    set updated item in list (text)
    if updated PK == current PK
        if updated mod serial <= current mod serial
            return
        end if
        if dirty
            warning dialog???
            de-select current in list
            get from screen into current
            current = clone
            put current to screen
            add current to list (text, name)
            add current to listener
            select current in list
        else
            warning dialog???
            current = read from database
            put current to screen
        end if
    end if

delete item (from listener) [synchronized (currentItemLock)]
    remove deleted item from list
    if deleted PK == current PK
        if dirty
            warning dialog???
            get from screen into current
            current = clone
        else
            warning dialog
            current = create new
        end if
        put current to screen
        add current to list (text, name)
        add current to listener
        select current in list
    end if

(blank) new [synchronized (currentItemLock)]
    if dirty
        "must save or cancel first" ???
    else
        if current not null and current has never been saved to database
            remove current from list
            remove current from listener
        else
            de-select current in list
        end if
        current = create new
        put current to screen
        add current to list (text, name)
        add current to listener
        select current in list
    end if

copy to new [synchronized (currentItemLock)]
    if dirty
        "must save or cancel first" ???
    else
        if current has never been saved to database
            remove current from list
            remove current from listener
        else
            de-select current in list
        end if
        get from screen into current
        current = clone
        put current to screen
        add current to list (text, name)
        add current to listener
        select current in list
        dirty = true
    end if

save [synchronized (currentItemLock)] (boolean buildCounts)
    if dirty
        get from screen into current
        dirty = false
        if (buildCounts)
            build child count records
        end if
        current = save current to database
        if concurrent modification
            de-select current in list
            current = clone
            save current to database
            add current to list (text, name)
            add current to listener
            select current in list
        else
            set current item in list (text)
            (then triggers notification of updated item from listener; see above)
        end if
        put current to screen
    end if

delete [synchronized (currentItemLock)]
    ask user
    if current has never been saved to database
        remove current from list
        remove current from listener
    else
        delete from database
        (triggers notification of deleted item from listener; see above)
        de-select current in list
    end if
    current = create new
    put current to screen
    add current to list (text, name)
    add current to listener
    select current in list
    dirty = false

revert [synchronized (currentItemLock)]
    if dirty, ask user
    if current has never been saved to database
        remove current from list
        remove current from listener
        current = create new
        put current to screen
        add current to list (text, name)
        add current to listener
        select current in list
    else
        current = read from database
        put current to screen
        set current in list (text)
    end if
    dirty = false

change selection [synchronized (currentItemLock)]
    if dirty
        "must save or cancel first" ???
        restore prior selection in list
    else
        if current has never been saved to database
            remove current from list
            remove current from listener
        end if
        current = read from database
        prior selection = current
        put current to screen
    end if

run the counts
    save(true)
    current.run

routines:
    select current in list:
        prior selection = current selection
        select current in list

(app exit)
    if dirty
        "must save or cancel first"
        return false
    end if
    flagExit = true
    return true

(system shutdown event)
    stop monitor thread and join
    if dirty
        get from screen into current
        save current to database
        if concurrent modification
            current = clone
            save current to database
        end if
    end if
    flagExit = true
